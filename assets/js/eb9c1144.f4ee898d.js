"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[776],{94:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var n=r(4848),i=r(8453);const o={id:"04-u-workflow",title:"Workflow",sidebar_label:"Workflow"},s=void 0,a={id:"04-u-workflow",title:"Workflow",description:"The workflow and application usecases are demonstrated using source code from the boost/interprocess library. Boost versions 1.52 and 1.54 are used and refered below as the 'previous' version and the 'current' version accordingly.",source:"@site/docs/04-u-workflow.md",sourceDirName:".",slug:"/04-u-workflow",permalink:"/metrixplusplus/docs/04-u-workflow",draft:!1,unlisted:!1,editUrl:"https://metrixplusplus.github.io/docs/04-u-workflow.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{id:"04-u-workflow",title:"Workflow",sidebar_label:"Workflow"},sidebar:"someSidebar",previous:{title:"Getting started",permalink:"/metrixplusplus/docs/03-u-getting-started"},next:{title:"Extending the tool",permalink:"/metrixplusplus/docs/05-u-extending-tool"}},c={},l=[{value:"Collect data",id:"collect-data",level:2},{value:"View data",id:"view-data",level:2},{value:"Summary metrics and distribution tables/graphs",id:"summary-metrics-and-distribution-tablesgraphs",level:3},{value:"Reducing analysis scope",id:"reducing-analysis-scope",level:3},{value:"Detailed metrics per file/region",id:"detailed-metrics-per-fileregion",level:3},{value:"More about the viewer",id:"more-about-the-viewer",level:3},{value:"Apply thresholds",id:"apply-thresholds",level:2},{value:"Hotspots",id:"hotspots",level:3},{value:"Controlling trends",id:"controlling-trends",level:3},{value:"Modes to exclude old code from the considiration",id:"modes-to-exclude-old-code-from-the-considiration",level:4},{value:"Suppressions",id:"suppressions",level:4},{value:"Other applications",id:"other-applications",level:2},{value:"Checking data file properties",id:"checking-data-file-properties",level:3},{value:"Exporting results",id:"exporting-results",level:3},{value:"Exporting reports",id:"exporting-reports",level:3}];function d(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:["The workflow and application usecases are demonstrated using source code from the ",(0,n.jsx)(t.a,{href:"http://www.boost.org/doc/libs/1_54_0/doc/html/interprocess.html",children:"boost/interprocess library"}),". Boost versions 1.52 and 1.54 are used and refered below as the 'previous' version and the 'current' version accordingly."]}),"\n",(0,n.jsx)(t.h2,{id:"collect-data",children:"Collect data"}),"\n",(0,n.jsx)(t.p,{children:"The first step is to collect the data. The 'collect' tool has got multiple options to enable various metrics plugins. Let's collect the number of lines of code and cyclomatic complexity metrics for the previous (1.52.0 version) boost interprocess library. Assuming that 2 versions of boost library are unpacked in the current working directory:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> cd boost_1_52_0\r\n> python "/path/to/metrix++.py" collect --std.code.lines.code --std.code.complexity.cyclomatic -- boost/interprocess\r\n> cd ../ # return back to working directory\n'})}),"\n",(0,n.jsxs)(t.p,{children:["The list of arguments after '--' enumerates the paths to read the source files. As a result of execution of this command, a file ",(0,n.jsx)(t.strong,{children:"metrixpp.db"})," will be written in the current working directory. It can be redefined using the ",(0,n.jsx)(t.strong,{children:"--db-file"})," option."]}),"\n",(0,n.jsx)(t.p,{children:"Metrix++ can compare code bases which reduces processing scope to the modified or new code. So, let's collect the same data for the current (1.54.0 version) boost interprocess library."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> cd boost_1_54_0\r\n> python "/path/to/metrix++.py" collect --std.code.lines.code --std.code.complexity.cyclomatic -- boost/interprocess --db-file-prev=../boost_1_52_0/metrixpp.db\r\n> cd ../ # return back to working directory\n'})}),"\n",(0,n.jsxs)(t.p,{children:["The option ",(0,n.jsx)(t.strong,{children:"--db-file-prev"})," points to the file with the data collected in the previous step. So, eventually it executed iterative collection. It can speed up the exectuion significantly, depending on amount of changes between two version."]}),"\n",(0,n.jsx)(t.p,{children:"Check other options of the collect tool by executing:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" collect --help\n'})}),"\n",(0,n.jsx)(t.h2,{id:"view-data",children:"View data"}),"\n",(0,n.jsx)(t.h3,{id:"summary-metrics-and-distribution-tablesgraphs",children:"Summary metrics and distribution tables/graphs"}),"\n",(0,n.jsx)(t.p,{children:"It is time to look at the data files collected (step above). The command:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" view --db-file=boost_1_54_0/metrixpp.db\n'})}),"\n",(0,n.jsx)(t.p,{children:"prints summary metrics, like minimum/maximum, and distribution/frequency tables:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:":: info: Overall metrics for 'std.code.complexity:cyclomatic' metric\r\n\tAverage        : 0.652902698283\r\n\tMinimum        : 0\r\n\tMaximum        : 37\r\n\tTotal          : 1597.0\r\n\tDistribution   : 2446 regions in total (including 0 suppressed)\r\n\t  Metric value : Ratio : R-sum : Number of regions\r\n\t             0 : 0.771 : 0.771 : 1886\t|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\r\n\t             1 : 0.110 : 0.881 :  268\t|||||||||||\r\n\t             2 : 0.044 : 0.925 :  108\t||||\r\n\t             3 : 0.025 : 0.949 :   60\t||\r\n\t             4 : 0.016 : 0.966 :   40\t||\r\n\t             5 : 0.007 : 0.973 :   18\t|\r\n\t             6 : 0.006 : 0.979 :   14\t|\r\n\t             7 : 0.004 : 0.983 :   10\t\r\n\t             8 : 0.003 : 0.986 :    8\t\r\n\t             9 : 0.002 : 0.988 :    4\t\r\n\t            10 : 0.004 : 0.991 :    9\t\r\n\t            11 : 0.002 : 0.993 :    4\t\r\n\t            12 : 0.001 : 0.994 :    3\t\r\n\t            13 : 0.001 : 0.995 :    2\t\r\n\t            14 : 0.001 : 0.996 :    2\t\r\n\t         15-16 : 0.001 : 0.997 :    3\t\r\n\t         17-18 : 0.001 : 0.998 :    3\t\r\n\t            20 : 0.000 : 0.999 :    1\t\r\n\t         23-25 : 0.001 : 1.000 :    2\t\r\n\t            37 : 0.000 : 1.000 :    1\t\r\n\r\n:: info: Overall metrics for 'std.code.lines:code' metric\r\n\tAverage        : 6.64356984479\r\n\tMinimum        : 0\r\n\tMaximum        : 201\r\n\tTotal          : 23970.0\r\n\tDistribution   : 3608 regions in total (including 0 suppressed)\r\n\t  Metric value : Ratio : R-sum : Number of regions\r\n\t           0-1 : 0.088 : 0.088 :  319\t|||||||||\r\n\t             2 : 0.320 : 0.409 : 1155\t||||||||||||||||||||||||||||||||\r\n\t             3 : 0.108 : 0.517 :  390\t|||||||||||\r\n\t             4 : 0.081 : 0.598 :  294\t||||||||\r\n\t             5 : 0.080 : 0.678 :  290\t||||||||\r\n\t             6 : 0.061 : 0.739 :  220\t||||||\r\n\t             7 : 0.049 : 0.788 :  176\t|||||\r\n\t             8 : 0.030 : 0.818 :  109\t|||\r\n\t             9 : 0.025 : 0.843 :   89\t||\r\n\t         10-11 : 0.032 : 0.876 :  117\t|||\r\n\t         12-13 : 0.020 : 0.895 :   71\t||\r\n\t            14 : 0.012 : 0.907 :   43\t|\r\n\t         15-16 : 0.017 : 0.924 :   61\t||\r\n\t         17-19 : 0.015 : 0.939 :   55\t||\r\n\t         20-22 : 0.013 : 0.952 :   46\t|\r\n\t         23-26 : 0.011 : 0.963 :   40\t|\r\n\t         27-30 : 0.009 : 0.972 :   33\t|\r\n\t         31-39 : 0.009 : 0.981 :   33\t|\r\n\t         40-65 : 0.009 : 0.991 :   34\t|\r\n\t        66-201 : 0.009 : 1.000 :   33\t|\r\n\r\n:: info: Directory content:\r\n\tDirectory      : .\n"})}),"\n",(0,n.jsxs)(t.p,{children:["The same command with ",(0,n.jsx)(t.strong,{children:"--db-file-prev"})," option enables comparision and change trends are shown in [] brackets:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" view --db-file=boost_1_54_0/metrixpp.db --db-file-prev=boost_1_52_0/metrixpp.db\n'})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:":: info: Overall metrics for 'std.code.complexity:cyclomatic' metric\r\n\tAverage        : 0.652902698283 [+0.00362138411453]\r\n\tMinimum        : 0 [+0]\r\n\tMaximum        : 37 [+1]\r\n\tTotal          : 1597.0 [+16.0]\r\n\tDistribution   : 2446 [+11] regions in total (including 0 [+0] suppressed)\r\n\t  Metric value : Ratio : R-sum : Number of regions\r\n\t             0 : 0.771 : 0.771 : 1886 [+5   ]\t|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\r\n\t             1 : 0.110 : 0.881 :  268 [+4   ]\t|||||||||||\r\n\t             2 : 0.044 : 0.925 :  108 [+0   ]\t||||\r\n\t             3 : 0.025 : 0.949 :   60 [+2   ]\t||\r\n\t             4 : 0.016 : 0.966 :   40 [-1   ]\t||\r\n\t             5 : 0.007 : 0.973 :   18 [-1   ]\t|\r\n\t             6 : 0.006 : 0.979 :   14 [+1   ]\t|\r\n\t             7 : 0.004 : 0.983 :   10 [+1   ]\t\r\n\t             8 : 0.003 : 0.986 :    8 [+1   ]\t\r\n\t             9 : 0.002 : 0.988 :    4 [+0   ]\t\r\n\t            10 : 0.004 : 0.991 :    9 [-2   ]\t\r\n\t            11 : 0.002 : 0.993 :    4 [+1   ]\t\r\n\t            12 : 0.001 : 0.994 :    3 [+0   ]\t\r\n\t            13 : 0.001 : 0.995 :    2 [+0   ]\t\r\n\t            14 : 0.001 : 0.996 :    2 [+0   ]\t\r\n\t         15-16 : 0.001 : 0.997 :    3 [-1   ]\t\r\n\t         17-18 : 0.001 : 0.998 :    3 [+1   ]\t\r\n\t            20 : 0.000 : 0.999 :    1 [+0   ]\t\r\n\t         23-25 : 0.001 : 1.000 :    2 [+0   ]\t\r\n\t         36-37 : 0.000 : 1.000 :    1 [+0   ]\t\r\n\r\n:: info: Overall metrics for 'std.code.lines:code' metric\r\n\tAverage        : 6.64356984479 [+0.012181964309]\r\n\tMinimum        : 0 [+0]\r\n\tMaximum        : 201 [+4]\r\n\tTotal          : 23970.0 [+223.0]\r\n\tDistribution   : 3608 [+27] regions in total (including 0 [+0] suppressed)\r\n\t  Metric value : Ratio : R-sum : Number of regions\r\n\t           0-1 : 0.088 : 0.088 :  319 [+3   ]\t|||||||||\r\n\t             2 : 0.320 : 0.409 : 1155 [+9   ]\t||||||||||||||||||||||||||||||||\r\n\t             3 : 0.108 : 0.517 :  390 [-3   ]\t|||||||||||\r\n\t             4 : 0.081 : 0.598 :  294 [+7   ]\t||||||||\r\n\t             5 : 0.080 : 0.678 :  290 [+7   ]\t||||||||\r\n\t             6 : 0.061 : 0.739 :  220 [-1   ]\t||||||\r\n\t             7 : 0.049 : 0.788 :  176 [-2   ]\t|||||\r\n\t             8 : 0.030 : 0.818 :  109 [-1   ]\t|||\r\n\t             9 : 0.025 : 0.843 :   89 [+4   ]\t||\r\n\t         10-11 : 0.032 : 0.876 :  117 [+9   ]\t|||\r\n\t         12-13 : 0.020 : 0.895 :   71 [-9   ]\t||\r\n\t            14 : 0.012 : 0.907 :   43 [+0   ]\t|\r\n\t         15-16 : 0.017 : 0.924 :   61 [+0   ]\t||\r\n\t         17-19 : 0.015 : 0.939 :   55 [+6   ]\t||\r\n\t         20-22 : 0.013 : 0.952 :   46 [-3   ]\t|\r\n\t         23-26 : 0.011 : 0.963 :   40 [+2   ]\t|\r\n\t         27-30 : 0.009 : 0.972 :   33 [-3   ]\t|\r\n\t         31-39 : 0.009 : 0.981 :   33 [+0   ]\t|\r\n\t         40-65 : 0.009 : 0.991 :   34 [+1   ]\t|\r\n\t        66-201 : 0.009 : 1.000 :   33 [+1   ]\t|\r\n\r\n:: info: Directory content:\r\n\tDirectory      : .\n"})}),"\n",(0,n.jsx)(t.h3,{id:"reducing-analysis-scope",children:"Reducing analysis scope"}),"\n",(0,n.jsx)(t.p,{children:"There are two ways to reduce the analysis scope for the view tool. The first is to enumerate paths of interest. For example, the following command reduces scope to the 'allocators' sub-directory within the processed code."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" view --db-file=boost_1_54_0/metrixpp.db -- ./boost/interprocess/allocators\n'})}),"\n",(0,n.jsxs)(t.p,{children:["The second is to specify the ",(0,n.jsx)(t.strong,{children:"--scope-mode option"}),", which instructs the tool to process only modified and/or new files/regions. For example, to view the summary metrics for all modified and new regions:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" view --db-file=boost_1_54_0/metrixpp.db  --db-file-prev=boost_1_52_0/metrixpp.db --scope-mode=touched\n'})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:":: info: Overall metrics for 'std.code.complexity:cyclomatic' metric\r\n\tAverage        : 1.84924623116 [-0.0230941943761]\r\n\tMinimum        : 0 [+0]\r\n\tMaximum        : 37 [+1]\r\n\tTotal          : 368.0 [+16.0]\r\n\tDistribution   : 199 [+11] regions in total (including 0 [+0] suppressed)\r\n\t  Metric value : Ratio : R-sum : Number of regions\r\n\t             0 : 0.608 : 0.608 : 121 [+5  ]\t|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\r\n\t             1 : 0.131 : 0.739 :  26 [+4  ]\t|||||||||||||\r\n\t             2 : 0.070 : 0.809 :  14 [+0  ]\t|||||||\r\n\t             3 : 0.060 : 0.869 :  12 [+2  ]\t||||||\r\n\t             4 : 0.015 : 0.884 :   3 [-1  ]\t||\r\n\t             5 : 0.015 : 0.899 :   3 [-1  ]\t||\r\n\t             6 : 0.005 : 0.905 :   1 [+1  ]\t|\r\n\t             7 : 0.015 : 0.920 :   3 [+1  ]\t||\r\n\t             8 : 0.015 : 0.935 :   3 [+1  ]\t||\r\n\t             9 : 0.010 : 0.945 :   2 [+0  ]\t|\r\n\t            10 : 0.010 : 0.955 :   2 [-2  ]\t|\r\n\t            11 : 0.005 : 0.960 :   1 [+1  ]\t|\r\n\t            12 : 0.005 : 0.965 :   1 [+0  ]\t|\r\n\t            13 : 0.005 : 0.970 :   1 [+0  ]\t|\r\n\t            16 : 0.005 : 0.975 :   1 [-1  ]\t|\r\n\t            17 : 0.005 : 0.980 :   1 [+0  ]\t|\r\n\t            18 : 0.010 : 0.990 :   2 [+1  ]\t|\r\n\t            20 : 0.005 : 0.995 :   1 [+0  ]\t|\r\n\t         36-37 : 0.005 : 1.000 :   1 [+0  ]\t|\r\n\r\n:: info: Overall metrics for 'std.code.lines:code' metric\r\n\tAverage        : 15.9645390071 [-0.815853149771]\r\n\tMinimum        : 0 [+0]\r\n\tMaximum        : 201 [+6]\r\n\tTotal          : 4502.0 [+223.0]\r\n\tDistribution   : 282 [+27] regions in total (including 0 [+0] suppressed)\r\n\t  Metric value : Ratio : R-sum : Number of regions\r\n\t           0-1 : 0.053 : 0.053 :  15 [+3  ]\t|||||\r\n\t             2 : 0.124 : 0.177 :  35 [+9  ]\t||||||||||||\r\n\t             3 : 0.053 : 0.230 :  15 [-3  ]\t|||||\r\n\t             4 : 0.060 : 0.291 :  17 [+7  ]\t||||||\r\n\t             5 : 0.089 : 0.379 :  25 [+7  ]\t|||||||||\r\n\t             6 : 0.060 : 0.440 :  17 [-1  ]\t||||||\r\n\t             7 : 0.050 : 0.489 :  14 [-2  ]\t|||||\r\n\t           8-9 : 0.074 : 0.564 :  21 [+3  ]\t|||||||\r\n\t            10 : 0.035 : 0.599 :  10 [+5  ]\t||||\r\n\t            11 : 0.082 : 0.681 :  23 [+4  ]\t||||||||\r\n\t         12-13 : 0.043 : 0.723 :  12 [-9  ]\t||||\r\n\t         14-15 : 0.039 : 0.762 :  11 [-1  ]\t||||\r\n\t         16-18 : 0.028 : 0.791 :   8 [+4  ]\t|||\r\n\t         19-22 : 0.039 : 0.830 :  11 [+0  ]\t||||\r\n\t         23-26 : 0.039 : 0.869 :  11 [+2  ]\t||||\r\n\t         27-32 : 0.028 : 0.897 :   8 [-3  ]\t|||\r\n\t         38-50 : 0.025 : 0.922 :   7 [+0  ]\t||\r\n\t         51-69 : 0.025 : 0.947 :   7 [+1  ]\t||\r\n\t        71-100 : 0.032 : 0.979 :   9 [+2  ]\t|||\r\n\t       101-201 : 0.021 : 1.000 :   6 [-1  ]\t||\r\n\r\n:: info: Directory content:\r\n\tDirectory      : .\n"})}),"\n",(0,n.jsx)(t.h3,{id:"detailed-metrics-per-fileregion",children:"Detailed metrics per file/region"}),"\n",(0,n.jsx)(t.p,{children:"The same view tool can print detailed metrics per file and per every region in the specified file. In order to get detailed metrics, enumerate files of interest after '--'. For example:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" view --db-file=boost_1_54_0/metrixpp.db --db-file-prev=boost_1_52_0/metrixpp.db -- ./boost/interprocess/detail/managed_open_or_create_impl.hpp\n'})}),"\n",(0,n.jsx)(t.p,{children:"produces output similar to this (truncated to make the page shorter):"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"./interprocess/detail/managed_open_or_create_impl.hpp:302: info: Metrics per 'priv_open_or_create' region\r\n\tRegion name    : priv_open_or_create\r\n\tRegion type    : function\r\n\tOffsets        : 8314-14526\r\n\tLine numbers   : 301-467\r\n\tModified       : True\r\n\tstd.code.complexity:cyclomatic: 37 [+1]\r\n\tstd.code.lines:code: 148 [+4]\n"})}),"\n",(0,n.jsx)(t.h3,{id:"more-about-the-viewer",children:"More about the viewer"}),"\n",(0,n.jsx)(t.p,{children:"The 'view' command has got an option to alter the output format. It is possible to get the same data in xml or python dictionary formats. This can be particularly useful for integration of the tool with other applications. For example, an editor may re-collect and show context based metrics when a file is saved."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" view --db-file=boost_1_54_0/metrixpp.db --format=xml\r\nCheck other options of the view tool by executing:\n'})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" view --help\n'})}),"\n",(0,n.jsx)(t.h2,{id:"apply-thresholds",children:"Apply thresholds"}),"\n",(0,n.jsx)(t.p,{children:"The viewer shows (above) that there are functions with quite large cyclomatic complexities. Growth of this metric can be considered as negative trend. The Metrix++ 'limit' tool offers the capability to manage control over trends by applying limits to metric values. Exceeded limits could be raised as alarms by quality management and control."}),"\n",(0,n.jsx)(t.h3,{id:"hotspots",children:"Hotspots"}),"\n",(0,n.jsx)(t.p,{children:"The hotspots mode of the limit tool helps to identify top files/regions exceeding a metric threshold. Let's identify the top 3 functions in the boost interprocess library, which exceed a limit of 15 points of cyclomatic complexity:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" limit --db-file=boost_1_54_0/metrixpp.db --max-limit=std.code.complexity:cyclomatic:15 --hotspots=3\n'})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"./interprocess/detail/managed_open_or_create_impl.hpp:302: warning: Metric 'std.code.complexity:cyclomatic' for region 'priv_open_or_create' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : priv_open_or_create\r\n\tMetric value   : 37\r\n\tModified       : None\r\n\tChange trend   : None\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\r\n\r\n./interprocess/streams/vectorstream.hpp:284: warning: Metric 'std.code.complexity:cyclomatic' for region 'seekoff' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : seekoff\r\n\tMetric value   : 25\r\n\tModified       : None\r\n\tChange trend   : None\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\r\n\r\n./interprocess/streams/bufferstream.hpp:174: warning: Metric 'std.code.complexity:cyclomatic' for region 'seekoff' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : seekoff\r\n\tMetric value   : 23\r\n\tModified       : None\r\n\tChange trend   : None\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\n"})}),"\n",(0,n.jsx)(t.h3,{id:"controlling-trends",children:"Controlling trends"}),"\n",(0,n.jsx)(t.p,{children:"The exit code of the 'limit' tool is equal to the number of warnings printed. This supports use of the tool as a static analysis tool during the software build process. In this case, a non-zero exit code means that there are violations to the agreed standards and it may fail the build. The same command without --hotspots option will print all regions/files exceeding the specified limit:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" limit --db-file=boost_1_54_0/metrixpp.db --max-limit=std.code.complexity:cyclomatic:15\n'})}),"\n",(0,n.jsx)(t.h4,{id:"modes-to-exclude-old-code-from-the-considiration",children:"Modes to exclude old code from the considiration"}),"\n",(0,n.jsx)(t.p,{children:"However, it is likely there are many warnings printed in this mode, especially if very old or legacy code is profiled against new metrics and coding rules. Although all warnings can be removed by re-factoring as a big task force activity, it is where many tools are rejected, because it is difficult to justify the initial cost of applying and integrating them. The Metrix++ 'limit' tool has got an option --warn-mode, which helps to overcome this problem."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"--warn-mode=touched"})," encourages re-factoring only for new and modified regions. It enables continuous refactoring. It does not matter how late the rule is applied or the coding standard is modified. It is possible to do it anytime with zero initial investment. For example, applying it to the boost interprocess library for a changes between 1.52 and 1.54 versions results in only 6 warnings:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" limit --db-file=boost_1_54_0/metrixpp.db --db-file-prev=boost_1_52_0/metrixpp.db --max-limit=std.code.complexity:cyclomatic:15 --warn-mode=touched\n'})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"./interprocess/detail/managed_open_or_create_impl.hpp:302: warning: Metric 'std.code.complexity:cyclomatic' for region 'priv_open_or_create' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : priv_open_or_create\r\n\tMetric value   : 37\r\n\tModified       : True\r\n\tChange trend   : +1\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\r\n\r\n./interprocess/ipc/message_queue.hpp:375: warning: Metric 'std.code.complexity:cyclomatic' for region 'insert_at' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : insert_at\r\n\tMetric value   : 16\r\n\tModified       : True\r\n\tChange trend   : 0\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\r\n\r\n./interprocess/mapped_region.hpp:575: warning: Metric 'std.code.complexity:cyclomatic' for region 'mapped_region' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : mapped_region\r\n\tMetric value   : 18\r\n\tModified       : True\r\n\tChange trend   : +2\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\r\n\r\n./interprocess/mem_algo/detail/mem_algo_common.hpp:452: warning: Metric 'std.code.complexity:cyclomatic' for region 'priv_allocate_many' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : priv_allocate_many\r\n\tMetric value   : 20\r\n\tModified       : True\r\n\tChange trend   : 0\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\r\n\r\n./interprocess/mem_algo/rbtree_best_fit.hpp:787: warning: Metric 'std.code.complexity:cyclomatic' for region 'priv_expand_both_sides' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : priv_expand_both_sides\r\n\tMetric value   : 17\r\n\tModified       : True\r\n\tChange trend   : 0\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\r\n\r\n./interprocess/sync/windows/named_sync.hpp:98: warning: Metric 'std.code.complexity:cyclomatic' for region 'open_or_create' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : open_or_create\r\n\tMetric value   : 18\r\n\tModified       : True\r\n\tChange trend   : 0\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\n"})}),"\n",(0,n.jsx)(t.p,{children:"If it is challenging or of little benefit to refactor everything touched, --warn-mode=trends simplifies the control over modified regions and only makes sure that there are no regressions in modified code. In other words, a warning is printed about a modified region/file only if a metric exceeds the specified limit and the value of the metric has got a negative trend due to the modification. It is possible to apply it anytime with zero initial investment and almost zero on-going investment around old code. For example, applying it to the boost interprocess library for a changes between 1.52 and 1.54 versions results in only 2 warnings:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" limit --db-file=boost_1_54_0/metrixpp.db --db-file-prev=boost_1_52_0/metrixpp.db --max-limit=std.code.complexity:cyclomatic:15 --warn-mode=trend\n'})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"./interprocess/detail/managed_open_or_create_impl.hpp:302: warning: Metric 'std.code.complexity:cyclomatic' for region 'priv_open_or_create' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : priv_open_or_create\r\n\tMetric value   : 37\r\n\tModified       : True\r\n\tChange trend   : +1\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\r\n\r\n./interprocess/mapped_region.hpp:575: warning: Metric 'std.code.complexity:cyclomatic' for region 'mapped_region' exceeds the limit.\r\n\tMetric name    : std.code.complexity:cyclomatic\r\n\tRegion name    : mapped_region\r\n\tMetric value   : 18\r\n\tModified       : True\r\n\tChange trend   : +2\r\n\tLimit          : 15.0\r\n\tSuppressed     : False\n"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"--warn-mode=new"})," ignores existing code and ensures that warnings are only about new code. For example, applying it to the boost interprocess library for a changes between 1.52 and 1.54 versions results in 0 warnings, so it shows that the new code is totally compliant with the standard required in the example."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" limit --db-file=boost_1_54_0/metrixpp.db --db-file-prev=boost_1_52_0/metrixpp.db --max-limit=std.code.complexity:cyclomatic:15 --warn-mode=new\n'})}),"\n",(0,n.jsx)(t.h4,{id:"suppressions",children:"Suppressions"}),"\n",(0,n.jsx)(t.p,{children:"It is possible to suppress warnings. Suppressions are collected from comments in code and used by the 'limit' tool to filter out suppressed warnings. It supports fine grained control over false-positive warnings, if there are any."}),"\n",(0,n.jsx)(t.p,{children:"In order to suppress a warning:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"per region metrics: put the metrix++ instruction in the comments before the region, for example:"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cpp",children:'// This function returns string typed\r\n// representation of a name of a color,\r\n// requested by color\'s id\r\n// metrix++: suppress std.code.complexity:cyclomatic\r\nstd::string getColorName(int color_id)\r\n{\r\n\tswitch (color_id)\r\n\t{\r\n\tcase COLOR_RED:\r\n\t\treturn std::string("red")\r\n\tcase COLOR_GREEN:\r\n\t\treturn std::string("green")\r\n\tcase COLOR_BLUE:\r\n\t\treturn std::string("blue")\r\n\t/* and so on */\r\n\t}\r\n}\n'})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"per file metrics: put the metrix++ instruction in the comments at the beginning of a file, for example:"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cpp",children:"//\r\n// This file does processing of colors and brushes\r\n// \r\n// However, it is too long and big file, and there is no time\r\n// to split it into multiple file, so shut up the metrix++ warnings:\r\n// metrix++: suppress std.general:size\r\n//\r\n \r\nstd::string getColorName(int color_id)\r\n{\r\n\t...\r\n...\n"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"activate collection of suppressions:"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" collect --std.suppress\n'})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"run the 'limit' tool WITHOUT --disable-suppressions option:"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" limit ...\n'})}),"\n",(0,n.jsx)(t.h2,{id:"other-applications",children:"Other applications"}),"\n",(0,n.jsx)(t.h3,{id:"checking-data-file-properties",children:"Checking data file properties"}),"\n",(0,n.jsx)(t.p,{children:"The Metrix++ 'info' tool is helpful to check the properties of a data file, like the settings used to write it, collected metrics and files processed. For example:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'> python "/path/to/metrix++.py" info --db-file=boost_1_54_0/metrixpp.db\n'})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-boost_1_54_0/metrixpp.db::",metastring:"info: Created using plugins and settings:",children:"\tversion        : 1.0\r\n\tstd.code.complexity:version: 1.1\r\n\tstd.code.cpp:version: 1.1\r\n\tstd.code.cpp:files: *.c,*.cc,*.cpp,*.cxx,*.h,*.hh,*.hpp,*.hxx\r\n\tstd.code.cs:version: 1.0\r\n\tstd.code.cs:files: *.cs\r\n\tstd.code.java:version: 1.1\r\n\tstd.code.java:files: *.java\r\n\tstd.code.lines:version: 1.1\r\n\r\ntest_workflow.db:: info: Collected metrics:\r\n\tstd.code.complexity:cyclomatic: \r\n\tstd.code.lines:code: \r\n\r\n:: info: Processed files and checksums:\r\n\t./interprocess/allocators/detail/node_pool.hpp: 0xb099a7c3\r\n\t./interprocess/allocators/detail/node_tools.hpp: 0xaaf5044d\r\n\t./interprocess/anonymous_shared_memory.hpp: 0x2bf06cb0\r\n\t./interprocess/containers/allocation_type.hpp: 0x8e95cda0\r\n\t./interprocess/containers/containers_fwd.hpp: 0xa4d0d9f7\r\n\t./interprocess/containers/deque.hpp: 0x6dbb77af\r\n\t./interprocess/containers/flat_map.hpp: 0x6750338c\r\n\t...\n"})}),"\n",(0,n.jsx)(t.h3,{id:"exporting-results",children:"Exporting results"}),"\n",(0,n.jsx)(t.p,{children:"The Metrix++ 'export' tool exports data files to csv formated files. For example:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:'> python "/path/to/metrix++.py" export --db-file=boost_1_54_0/metrixpp.db > boost_1_54_0/metrixpp.csv\n'})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"file,region,type,modified,line start,line end,std.code.complexity:cyclomatic,std.code.lines:code\r\n./interprocess/allocators/detail/node_pool.hpp,__global__,global,,1,110,,0\r\n./interprocess/allocators/detail/node_pool.hpp,boost,namespace,,33,105,,2\r\n./interprocess/allocators/detail/node_pool.hpp,interprocess,namespace,,34,104,,2\r\n./interprocess/allocators/detail/node_pool.hpp,ipcdetail,namespace,,35,103,,4\r\n./interprocess/allocators/detail/node_pool.hpp,SegmentManager,class,,39,72,,16\r\n...\n"})}),"\n",(0,n.jsx)(t.p,{children:"Files with csv format can be opened by applications, like Microsoft Office Excel, with advanced analysis capabilities. For example, to draw this distribution graph:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Distribution graph",src:r(1939).A+"",width:"502",height:"359"})}),"\n",(0,n.jsx)(t.p,{children:"It is not recommended to use the export tool to implement custom post-analysis Metrix++ extensions. The main reason is that granted backward compatibility support for csv columns is not granted. Another main reason is that exporting is relatively slow process. It is recommended to use Metrix++ extensions API instead."}),"\n",(0,n.jsx)(t.h3,{id:"exporting-reports",children:"Exporting reports"}),"\n",(0,n.jsx)(t.p,{children:"The Metrix++ 'report' tool can be used to report the current data of all files\r\nand metrics which have been collected so far."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:'> python "/path/to/metrix++.py" report --db-file=boost_1_54_0/metrixpp.db --format=doxygen --output-dir=/path/to/generated/output\n'})}),"\n",(0,n.jsx)(t.p,{children:"This can be used to integrate metrics in automatically generated reports.\r\nCurrently the 'report' tool can generate data to be integrated in doxygen\r\ndocumentation. The tool creates a 'metrixpp.dox' file in the output directory."}),"\n",(0,n.jsx)(t.p,{children:"This will create an overview Table as seperate page:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Doxygen report overview",src:r(8308).A+"",width:"487",height:"310"})}),"\n",(0,n.jsx)(t.p,{children:"Create a new global list with metrix warnings (analog to the todo list):"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Doxygen warning list",src:r(8146).A+"",width:"829",height:"438"})}),"\n",(0,n.jsx)(t.p,{children:"And add a metrix section on top of every files documentation page:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Doxygen file documentation",src:r(8555).A+"",width:"714",height:"732"})}),"\n",(0,n.jsx)(t.p,{children:"The doxygen format requires pytablewriter to be installed."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"> pip install pytablewriter\n"})}),"\n",(0,n.jsx)(t.p,{children:"Besides the doxygen format the report can be used to create simple text 'txt' or\r\njson 'json' reports to be integrated in logs or other tools."}),"\n",(0,n.jsx)(t.p,{children:"If no output directory is given the result is printed to stdout."}),"\n",(0,n.jsxs)(t.p,{children:["The 'report' tool accepts the same options as the ",(0,n.jsx)(t.a,{href:"#apply-thresholds",children:"limit"}),"\r\ntool. The violated thresholds are added to the report as warnings."]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8555:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/doxygenFile-2f79f4ab2e6ad7bfc002aa8d9b95a2d7.png"},8308:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/doxygenOverview-bcad2fd262d415720431440322c2ed7c.png"},8146:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/doxygenWarnings-535380d8b60ef95da2d41d48586b93dc.png"},1939:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/piechart-136683eba62aff4d28b2126cc326715a.png"},8453:(e,t,r)=>{r.d(t,{R:()=>s,x:()=>a});var n=r(6540);const i={},o=n.createContext(i);function s(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);